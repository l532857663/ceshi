<html>
<head>
<title>ceshi</title>
<meta charset="utf-8"></meta>
</head>
<body>
	点击按钮，把数据生成Excel文件下载

	<p id="content_data">
		大江东去，浪淘尽。<br>
		<a name="top"></a>
		千古东流人物。<br>
		故垒西边，人道是，<br>
		三国周郎赤壁。<br>
		乱石穿空，惊涛拍岸，<br>
		卷起千堆雪。<br>
		<img src="img/3.jpg" alt="苏轼" style="width: 200px;height: 200px;">
		<br>
		江上如画，<br>
		一时多少豪杰。<br>
		遥想公瑾当年，<br。<br>
		羽扇纶巾，谈笑间，<br>
		樯橹灰飞烟灭。<br>
		故国神游，<br>
		多情应笑我，早生华发。<br>
		人生如梦，一尊还酹江月。<br>
		明月几时有？<br>
		把酒问青天。<br>
		不知天上宫阙，<br>
		今夕是何年。<br>
		我欲乘风归去，<br>
		又恐琼楼玉宇，<br>
		<img src="img/4.jpg" alt="景物" style="width:200px;height:200px;">
		<br>
		高处不胜寒。<br>
		起舞弄清影，<br>
		何似在人间？<br>
		转朱阁，低绮户，
		照无眠。<br>
		不应有恨，<br>
		何事长向别时圆？<br>
		人有悲欢离合，<br>
		月有阴晴圆缺，<br>
		此事古难全。<br>
		但愿人长久，<br>
		千里共婵娟。<br>
	</p>
<button onclick="ceshi()">测试
</button>
<script>
function ceshi() {
	download_data("content_data", "chibifu.xls")
}
//页面数据导出
function download_data(tableId, fileName){
    var scoreTable = "<html><head><meta charset='utf-8' /></head><body>" + document.getElementById(tableId).outerHTML + "</body></html>";
//  var blob = new Blob([scoreTable], {type: 'text/txt;charset=utf-8;'});
    var blob = new Blob([scoreTable], { type: "application/vnd.ms-excel" });
    var downloadLink = document.createElement("a");
    if ('download' in downloadLink) { // feature detection, Browsers that support HTML5 download attribute
        var url = URL.createObjectURL(blob);
        downloadLink.href = url;
        downloadLink.download = fileName;
        downloadLink.hidden = true;
        document.body.appendChild(downloadLink);
        downloadLink.click();
        document.body.removeChild(downloadLink);
    }else{
        if(navigator.msSaveBlob){ //IE10+
            navigator.msSaveBlob(blob, fileName);
        }
    }
}

</script>
</body>
</html>
